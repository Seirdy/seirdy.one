{{ define "main" }}
{{ .Scratch.Set "codeIndex" 1 }}
<div itemprop="blogPost mainEntity" itemscope itemtype="https://schema.org/BlogPosting">
	<article class="h-entry hentry">
		<header id="post-header">
			<h1 itemprop="name headline" class="p-name entry-title">{{ .Title }}</h1>
			<span class="dateline">
				Posted <time itemprop="dateCreated datePublished" class="dt-published published" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}" title="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Date.Format "2006-01-02" }}</time>
			</span>
				by {{- partial "indieweb-author.html" -}} on his <a rel="canonical" itemprop="mainEntityOfPage" class="u-url url" href="https://seirdy.one{{ .RelPermalink }}">Website</a>
				{{ with .OutputFormats.Get "gemtext" -}}
					and <a rel="syndication" class="u-syndication" href="{{replace .Permalink "/gemini" "" 1 | safeURL}}">Gemini capsule</a>
				{{- end -}}
			{{ if lt .Date .Lastmod -}}
				<br>
				Last updated <time itemprop="dateModified" class="dt-updated updated" datetime="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}" title="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">{{ .Lastmod.Format "2006-01-02" }}</time>. <a href="{{ .Site.Params.logUrlPrefix }}content/{{ .File.Path }}">Changelog</a>
			{{ end }}
			<br>
			<small>
				<span itemprop="wordCount">{{ .WordCount }}</span> words, a <span itemprop="timeRequired" content="PT{{ .ReadingTime }}M">{{ .ReadingTime }} minute</span> read
			</small>
			<hr>
		</header>
		<div class="e-content entry-content" itemprop="articleBody">
			{{ partial "processed-content" . -}}
		</div>
	</article>
	<!--the "comment" class is read by a few content extractors-->
	<section class="comment">
		<h2 id="webmentions">Webmen&shy;tions</h2>
		<p>This site supports <a href="https://indieweb.org/webmention">Webmentions</a>. Webmentions received for this post will appear below after I approve them. I sometimes send Webmentions to myself on behalf of linking sites that don't support them. Check the <a href="https://web.archive.org/">Wayback Machine</a> if any links are broken.</p>
		<ul class="unstyled-list">
			{{ $target := .RelPermalink -}}
			{{ $url := printf "https://seirdy.one/webmentions/get?status=approved&target=https://seirdy.one%s" $target -}}
			{{ $webmentions := getJSON $url -}}
			{{ range $webmentions -}}
			{{ $webmention := . -}}
				{{ if (eq $webmention.type "like") -}}
					<li itemprop="potentialAction" itemscope itemtype="https://schema.org/LikeAction" class="u-like h-cite">
				{{- else -}}
					<li itemprop="comment" itemscope itemtype="https://schema.org/Comment" class="u-comment h-cite">
				{{- end }}
				<time class="dt-published" itemprop="{{ if (eq $webmention.type "like") -}}startTime{{ else }}datePublished{{ end }}" datetime="{{ dateFormat "2006-01-02 15:04:05Z07:00" $webmention.created_at }}" title="{{ dateFormat "2006-01-02 15:04:05Z07:00" $webmention.created_at }}">{{ dateFormat "2006-01-02" $webmention.created_at }}</time>
				<br>
				{{ if (eq $webmention.type "like") -}}
					{{- if $webmention.author_name -}}
						<span itemprop="agent" itemscope itemtype="https://schema.org/Person" class="h-card p-author vcard"><span itemprop="name" class="p-name fn n">{{ $webmention.author_name }}</span></span>
					{{- else if $webmention.title -}}
						<span itemprop="name" class="p-name">{{ $webmention.title -}}</span>
					{{- else -}}
						{{ $webmention.source -}}
					{{- end }}
					<a class="u-url" href="{{ $webmention.source }}" rel="nofollow ugc">liked</a> this
				{{- else -}}
					<a class="u-url" href="{{ $webmention.source }}" rel="nofollow ugc"><span itemprop="name" class="p-content p-name">
						{{- if $webmention.title -}}
							{{- $webmention.title | truncate 200 -}}
						{{- else -}}
							{{- $webmention.source | truncate 35 -}}
						{{- end -}}
					</span></a>
					{{- if $webmention.author_name }}
						by <span itemprop="author" itemscope itemtype="https://schema.org/Person" class="h-card p-author vcard"><span itemprop="name" class="p-name fn n">{{ $webmention.author_name }}</span></span>
						{{- end -}}
				{{- end }}
				</li>
			{{ else -}}
				<li><p>This post doesn't have any approved Webmentions yet.</p></li>
			{{- end }}
		</ul>
		<h2 id="contact">Contact</h2>
		<p><a href="mailto:~seirdy/seirdy.one-comments@lists.sr.ht">Send an email</a> to leave a comment in the <a href="https://lists.sr.ht/~seirdy/seirdy.one-comments">mailing list</a> for seirdy.one. You'll have to send in plain text; please <a href="https://useplaintext.email/">learn how</a>. Alternatively, send your email <a href="mailto:seirdy@seirdy.one">directly to me</a>; it won’t show up on the mailing list, but I’ll see it.</p>
		<p></p>
	</section>
</div>
{{ end }}
